(this["webpackJsonpyaanimail-chrome-extension"]=this["webpackJsonpyaanimail-chrome-extension"]||[]).push([[0],{102:function(e){e.exports=JSON.parse('{"E-MAIL":"E-mail","PASSWORD":"Password","LOGIN":"Login","LOGOUT":"Logout","NO_UNREAD_MAILS":"No unread e-mails...","UNREAD":"Unread","UNREAD_MAIL_COUNT":"Unread E-Mail Count"}')},103:function(e){e.exports=JSON.parse('{"E-MAIL":"E-posta","PASSWORD":"\u015eifre","LOGIN":"Giri\u015f","LOGOUT":"\xc7\u0131k\u0131\u015f","NO_UNREAD_MAILS":"Okunmam\u0131\u015f mail yoktur...","UNREAD":"Okunmam\u0131\u015f","UNREAD_MAIL_COUNT":"Okunmam\u0131\u015f mail say\u0131s\u0131"}')},104:function(e,t,n){"use strict";n.r(t);var a=n(0),c=n.n(a),r=n(11),o=n.n(r),i=(n(64),n(65),n(66),n(67),n(68),n(8)),s=n(109),u=n(108),l=n.p+"static/media/logo.d732ee88.svg",d=n(6),j=n(21),f=n.n(j),h=n(111),g=n(113),b=n(114),m="SET_AUTHED_USER",O="LOGOUT";function v(e){return{type:m,authedUser:e}}function x(){return{type:O}}var p=n(14),y=function e(){Object(p.a)(this,e)};y.saveToLocalStorage=function(e,t){return new Promise((function(n,a){var c={};c[e]=t,chrome.storage.sync.set(c,(function(){n(t)}))}))},y.getFromLocalStorage=function(e){return new Promise((function(t,n){chrome.storage.sync.get(e,(function(e){e?t(e):n()}))}))},y.getGatewayApiUrl=function(){return"https://capi.yaanimail.com/gateway/v1"};var S=y,L=function e(){Object(p.a)(this,e)};L.getAuthHeaders=function(){return Promise.all([L.getUserToken(),L.getDeviceId()]).then((function(e){return 2==e.length?{Authorization:"Bearer "+e[0],"App-Version":"1.0","Device-Language":"en-US","Device-Name":"WEB","Device-ID":e[1]}:{}})).catch((function(e){console.error(e)}))},L.getNonAuthHeaders=function(){return new Promise((function(e,t){L.getDeviceId().then((function(t){e({"App-Version":"1.0","Device-Language":"en-US","Device-Name":"WEB","Device-ID":t})}))}))},L.getUserToken=function(){return new Promise((function(e,t){S.getFromLocalStorage("ym@user").then((function(n){if(0!==Object.keys(n).length){var a=JSON.parse(n["ym@user"]);e(a.access_token)}else t()}))}))},L.getDeviceId=function(){return new Promise((function(e,t){S.getFromLocalStorage("y@uuid").then((function(t){if(0!==Object.keys(t).length)e(t["y@uuid"]);else{var n=L.generateUUID();S.saveToLocalStorage("y@uuid",n).then((function(t){e(t)}))}}))}))},L.generateUUID=function(){for(var e=[],t="0123456789abcdef",n=0;n<36;n++)e[n]=t.substr(Math.floor(16*Math.random()),1);return e[14]="4",e[19]=t.substr(3&e[19]|8,1),e[8]=e[13]=e[18]=e[23]="-",e.join("")};var N=L,_=n(112),U=n(38),A=n(1);var D=Object(i.connect)()((function(){var e=Object(_.a)().t,t=Object(a.useState)(!0),n=Object(d.a)(t,2),c=(n[0],n[1]),r=Object(a.useState)(!1),o=Object(d.a)(r,2),s=(o[0],o[1],Object(a.useState)("")),u=Object(d.a)(s,2),l=u[0],j=u[1],m=Object(a.useState)(""),O=Object(d.a)(m,2),x=O[0],p=O[1],y=Object(i.useDispatch)();return Object(A.jsxs)("form",{onSubmit:function(e){e.preventDefault();var t={email:l,password:x,details:1};c(!0),N.getNonAuthHeaders().then((function(e){f.a.post(S.getGatewayApiUrl()+"/accounts/login",t,{headers:e}).then((function(e){c(!1),S.saveToLocalStorage("ym@user",JSON.stringify(e.data)).then((function(e){y(v(e))}))})).catch((function(e){console.log(e.message),U.b.error(e.message)}))}))},children:[Object(A.jsxs)("div",{className:"d-flex flex-column py-2",children:[Object(A.jsx)(h.a,{size:"sm",className:"mb-3",children:Object(A.jsx)(g.a,{placeholder:e("E-MAIL"),"aria-label":e("E-MAIL"),"aria-describedby":"basic-addon2",value:l,onChange:function(e){return j(e.target.value)}})}),Object(A.jsxs)(h.a,{size:"sm",className:"mb-3",children:[Object(A.jsx)(h.a.Text,{id:"inputGroup-sizing-sm",children:e("PASSWORD")}),Object(A.jsx)(g.a,{placeholder:e("PASSWORD"),"aria-label":e("PASSWORD"),"aria-describedby":"inputGroup-sizing-sm",type:"password",value:x,onChange:function(e){return p(e.target.value)}})]}),Object(A.jsx)("div",{children:Object(A.jsx)(b.a,{variant:"primary",className:"float-end",type:"submit",children:e("LOGIN")})})]}),Object(A.jsx)(U.a,{position:"bottom-left",autoClose:1500,closeOnClick:!0})]})})),I=n(17),E=f.a.create({baseURL:"https://capi.yaanimail.com/gateway/v1"});E.interceptors.response.use((function(e){return e}),(function(e){return 401===e.response.status?new Promise((function(e,t){S.saveToLocalStorage("ym@user",null).then((function(t){Object(i.useDispatch)(x()),e(t)})).catch((function(e){console.log(e),t(e)}))})):(e.response.message=function(e){var t,n=null===e||void 0===e||null===(t=e.error)||void 0===t?void 0:t.message;return n&&I.a.exists(n)?I.a.t(n):e.error.message}(e.response),Promise.reject(e))}));var M=function e(){Object(p.a)(this,e)};M.logout=function(){return new Promise((function(e,t){N.getAuthHeaders().then((function(n){E.delete("/accounts/logout",{headers:n}).then((function(t){e(t)})).catch((function(e){t(e.response)}))})).catch((function(e){console.log(e),t(e)}))}))};var w=M;var T=function(){var e=Object(_.a)().t,t=Object(a.useState)(!0),n=Object(d.a)(t,2),c=(n[0],n[1]),r=Object(a.useState)(!1),o=Object(d.a)(r,2),s=(o[0],o[1],Object(i.useDispatch)());return Object(A.jsx)(b.a,{variant:"danger",onClick:function(e){c(!0),chrome.action.setBadgeText({text:""}),w.logout().then((function(){S.saveToLocalStorage("ym@user",null).then((function(){c(!1),s(x())}))})).catch((function(e){c(!1),console.log(e)}))},children:e("LOGOUT")})},P=function e(){Object(p.a)(this,e)};P.getAllFolders=function(){return new Promise((function(e,t){N.getAuthHeaders().then((function(n){E.get("/emails/folders/all",{headers:n}).then((function(n){n.data?e(n):t(n.data.error)})).catch((function(e){t(e.response)}))})).catch((function(e){console.log(e),t(e)}))}))},P.getMails=function(e){var t=Object.entries(e).map((function(e){var t=Object(d.a)(e,2),n=t[0],a=t[1];return"".concat(n,"=").concat(a)})).join("&");return new Promise((function(e,n){N.getAuthHeaders().then((function(a){E.get("/emails/messages?".concat(t),{headers:a}).then((function(t){t.data?e(t):n(t.data.error)})).catch((function(e){n(e.response)}))})).catch((function(e){console.log(e),n(e)}))}))};var k=P,R=n(106),B=n(107);var C=function(){var e=Object(_.a)().t,t=Object(a.useState)(!0),n=Object(d.a)(t,2),c=n[0],r=n[1],o=Object(a.useState)(0),i=Object(d.a)(o,2),s=i[0],u=i[1];return Object(a.useEffect)((function(){r(!0),k.getAllFolders().then((function(e){r(!1);var t=e.data.filter((function(e){return 2==e.id})),n=t&&t.length>0?t[0].unread:0;u(n),chrome.action.setBadgeText({text:""}),0!==n&&chrome.action.setBadgeText({text:"".concat(n>999?"+999":n)})})).catch((function(t){r(!1),chrome.action.setBadgeText({text:""}),console.log(t),t&&t.data&&console.log(e(t.data.message))}))}),[]),Object(A.jsxs)(b.a,{variant:"primary",children:[e("UNREAD")," ",c?Object(A.jsx)(R.a,{as:"span",animation:"grow",size:"sm",role:"status","aria-hidden":"true"}):Object(A.jsx)(B.a,{bg:"secondary",children:s>999?"+999":s}),Object(A.jsx)("span",{className:"visually-hidden",children:e("UNREAD_MAIL_COUNT")})]})};var H=Object(i.connect)((function(e){var t=e.authedUser;return{isLoggedIn:!!t,authedUser:t}}))((function(e){return Object(A.jsx)(s.a,{bg:"light",children:Object(A.jsxs)(u.a,{children:[Object(A.jsx)(s.a.Brand,{href:"#home",children:Object(A.jsx)("img",{alt:"YaaniMail",src:l,width:"150",className:"d-inline-block align-top pt-1"})}),!1===e.isLoggedIn?Object(A.jsx)(D,{}):Object(A.jsxs)(a.Fragment,{children:[Object(A.jsx)(C,{}),Object(A.jsx)(T,{})]})]})})})),F=n(57),G=n.n(F),J=n(24);function W(){return function(e){return e(Object(J.showLoading)()),new Promise((function(e,t){S.getFromLocalStorage("ym@user").then((function(t){0!==Object.keys(t).length?e({authedUser:JSON.parse(t["ym@user"])}):e({})}))})).then((function(t){var n=t.authedUser;n&&e(v(n)),e(Object(J.hideLoading)())}))}}var Y=Object(i.connect)((function(e){var t=e.authedUser;return{language:t?t.language:"tr"}}))((function(e){var t=Object(_.a)().i18n,n=Object(i.useDispatch)();return Object(a.useEffect)((function(){n(W())}),[]),Object(a.useEffect)((function(){t.changeLanguage(e.language||"tr")}),[e.language]),Object(A.jsxs)("div",{children:[Object(A.jsx)(H,{}),Object(A.jsx)("main",{className:G.a.main,children:e.children})]})})),z=n(110),V=n(58),q=n.n(V),X=n(25),K=n.n(X),Q=n.p+"static/media/icon-mail.edfb9dec.png";var Z=Object(i.connect)((function(e){var t=e.authedUser;return{accountMail:t?t.client_id:""}}))((function(e){var t=Object(_.a)().t,n=Object(a.useState)(!0),c=Object(d.a)(n,2),r=c[0],o=c[1],i=Object(a.useState)([]),s=Object(d.a)(i,2),u=s[0],l=s[1];return Object(a.useEffect)((function(){o(!0);k.getMails({folder:"inbox",limit:5,message_listing_type:"message",offset:0,order:"date",order_type:"desc",flag:!1,unread:!0,attachment:!1,search:"*"}).then((function(e){o(!1),l(e.data)})).catch((function(e){o(!1),console.log(e),e&&e.data&&console.log(t(e.data.message))}))}),[]),Object(A.jsxs)(a.Fragment,{children:[r?Object(A.jsx)("div",{className:"container h-100",children:Object(A.jsx)("div",{className:"d-flex justify-content-center align-items-center ".concat(K.a.vh70),children:Object(A.jsx)(R.a,{animation:"border",variant:"info"})})}):u&&u.map((function(t){return Object(A.jsx)("div",{onClick:function(){return function(t){var n="https://kurumsal.yaanimail.com/m/".concat(e.accountMail,"/PRIMARY/inbox/single/").concat(t,"/details");chrome.tabs.create({url:n},(function(e){}))}(t.id)},children:Object(A.jsxs)(z.a,{border:"info",children:[Object(A.jsxs)(z.a.Header,{children:[t.from.map((function(e){return e.full_name&&e.full_name.length>0?e.full_name:e.first_name}))," ","- ",q.a.unix(t.time).format("MMMM Do YYYY, h:mm:ss a")]}),Object(A.jsxs)(z.a.Body,{children:[Object(A.jsx)(z.a.Text,{className:"fw-bold",children:t.subject}),Object(A.jsx)(z.a.Text,{children:t.first_line})]})]})})})),!r&&(!u||0===u.length)&&Object(A.jsxs)("div",{className:"container h-100",children:[Object(A.jsx)("div",{className:"d-flex justify-content-center align-items-center ".concat(K.a.vh70),children:Object(A.jsx)("img",{src:Q,alt:"Login",className:"not-found-image"})}),Object(A.jsx)("p",{class:"text-center text-primary fw-bold fs-6",children:t("NO_UNREAD_MAILS")})]})]})}));var $=Object(i.connect)((function(e){return{isLoggedIn:!!e.authedUser}}))((function(e){return e.isLoggedIn?Object(A.jsx)(Z,{}):Object(A.jsx)("div",{className:"container h-100",children:Object(A.jsx)("div",{className:"d-flex justify-content-center align-items-center ".concat(K.a.vh70),children:Object(A.jsx)("img",{src:Q,alt:"Login",className:"not-found-image"})})})}));var ee=function(){return Object(A.jsx)(Y,{children:Object(A.jsx)($,{})})},te=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,115)).then((function(t){var n=t.getCLS,a=t.getFID,c=t.getFCP,r=t.getLCP,o=t.getTTFB;n(e),a(e),c(e),r(e),o(e)}))},ne=n(18);var ae=Object(ne.b)({authedUser:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case m:return t.authedUser;case O:return null;default:return e}},loadingBar:J.loadingBarReducer}),ce=n(59),re=Object(ne.a)(ce.a),oe=n(26);I.a.use(oe.e).init({fallbackLng:"en",lng:"en",resources:{en:{translations:n(102)},tr:{translations:n(103)}},ns:["translations"],defaultNS:"translations"}),I.a.languages=["en","tr"];I.a;var ie=Object(ne.c)(ae,re);o.a.render(Object(A.jsx)(c.a.StrictMode,{children:Object(A.jsx)(i.Provider,{store:ie,children:Object(A.jsx)(ee,{})})}),document.getElementById("root")),te()},25:function(e,t,n){e.exports={vh70:"Mailbox_vh70__3XhAL"}},57:function(e,t,n){e.exports={main:"Layout_main__auk_r"}},64:function(e,t,n){},65:function(e,t,n){},68:function(e,t,n){e.exports={header:"Header_header__2otSh",logo:"Header_logo__2yYRj",active:"Header_active__WHMYj",badge:"Header_badge__1yJvq"}}},[[104,1,2]]]);
//# sourceMappingURL=main.b9754969.chunk.js.map